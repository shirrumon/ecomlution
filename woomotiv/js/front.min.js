!function(i){var a,e=i("body"),o=woomotivObj.nonce,n=woomotivObj.ajax_url,r=0,c=!1,d=[],l=!1,f=!1,p=1e3*parseInt(woomotivObj.interval),w=1e3*parseInt(woomotivObj.hide),s=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,m=window.cancelAnimationFrame||window.mozCancelAnimationFrame,v={products:[],reviews:[],custom:[]},h=1===parseInt(woomotivObj.is_no_repeat_enabled)&&1===parseInt(woomotivObj.is_premium)?1:0,b="woomotiv_seen_products_"+woomotivObj.site_hash,g="woomotiv_seen_reviews_"+woomotivObj.site_hash,_="woomotiv_seen_custompop_"+woomotivObj.site_hash,t=function(){var t,e=document.createElement("fakeelement"),o={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in o)if(void 0!==e.style[t])return o[t]}(),u=function(){var t,e=document.createElement("fakeelement"),o={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in o)if(void 0!==e.style[t])return o[t]}(),k=(function(){var t,e=document.createElement("fakeelement"),o={transition:"transitionstart",OTransition:"oTransitionStart",MozTransition:"transitionstart",WebkitTransition:"webkitTransitionStart"};for(t in o)if(void 0!==e.style[t])return}(),function(){var t,e=document.createElement("fakeelement"),o={animation:"animationstart",OAnimation:"oAnimationStart",MozAnimation:"animationstart",WebkitAnimation:"webkitAnimationStart"};for(t in o)if(void 0!==e.style[t])return}(),["fade","slideup","slidedown","slideright","slideleft"]),O=(k.indexOf(woomotivObj.animation),-1!=k.indexOf(woomotivObj.animation)?t:u);function T(t,e){return(e="object"==typeof e?e:{}).action="woomotiv_"+t,e.hasOwnProperty("nonce")||(e.nonce=o),i.ajax({type:"POST",url:n,data:e})}function I(m){m=parseInt(m);var u=d[(r=m)-1];u.addClass("wmt-current"),u.one(O,function(){var e,o,n,t,i,a,r,s;u.is('[data-type="product"]')?(a=parseInt(u.attr("data-orderitemid")),v.products=v.products.filter(function(t){return t!=a}),v.products.push(a),h&&(r=j(),s=!1,r.map(function(t){t==a&&(s=!0)}),s||(r.push(a),localStorage.setItem(b,r.join(","))))):u.is('[data-type="review"]')?(n=parseInt(u.attr("data-review")),v.reviews=v.reviews.filter(function(t){return t!=n}),v.reviews.push(n),h&&(t=y(),i=!1,t.map(function(t){t==n&&(i=!0)}),i||(t.push(n),localStorage.setItem(g,t.join(","))))):u.is('[data-type="custom"]')&&(e=parseInt(u.attr("data-id")),v.custom=v.custom.filter(function(t){return t!=e}),v.custom.push(e),h&&(t=S(),o=!1,t.map(function(t){t==e&&(o=!0)}),o||(t.push(e),localStorage.setItem(_,t.join(","))))),f=setTimeout(function(){u.removeClass("wmt-current"),u.one(O,function(){l=setTimeout(function(){m!==d.length||c?m===d.length&&c?h?(A(),v.products=[],v.reviews=[],v.custom=[]):I(1):I(m+1):(h&&(v.products=j(),v.reviews=y(),v.custom=S()),D(v))},p)})},w)})}function j(){var t=localStorage.getItem(b);return(t=t?t.split(","):[]).filter(function(t){return""!==t})}function y(){var t=localStorage.getItem(g);return(t=t?t.split(","):[]).filter(function(t){return""!==t})}function S(){var t=localStorage.getItem(_);return(t=t?t.split(","):[]).filter(function(t){return""!==t})}function A(){localStorage.removeItem(b),localStorage.removeItem(g),localStorage.removeItem(_)}function D(t){T("get_items",{excluded:t}).done(function(t){if(t.hasOwnProperty("data")&&""!==t.data&&(0!==t.data.length||0!==d.length)){if(0===t.data.length)return c=!0,void I(1);t.data.map(function(t){t=i(t.markup);t.attr("data-index",d.length+1),e.append(t),d.push(t),t.on("mouseenter",function(t){i(this).off(O),clearTimeout(l),clearTimeout(f),m(a)}),t.on("mouseleave",function(t){var e=i(".woomotiv-popup.wmt-current"),o=parseInt(e.attr("data-index")),n=parseInt(w/2);void 0!==o&&(setTimeout(function(){e.removeClass("wmt-current")},n),setTimeout(function(){a=s(function(){I(o+1)})},w+w))}),t.find(".woomotiv-close").on("click",function(t){t.preventDefault(),i(".woomotiv-popup").remove(),localStorage.setItem("woomotiv_pause_date_"+woomotivObj.site_hash,function(t,e,o){function n(){i.getDate()!=t.getDate()&&i.setDate(0)}var i=new Date(t);switch(e.toLowerCase()){case"year":i.setFullYear(i.getFullYear()+o),n();break;case"quarter":i.setMonth(i.getMonth()+3*o),n();break;case"month":i.setMonth(i.getMonth()+o),n();break;case"week":i.setDate(i.getDate()+7*o);break;case"day":i.setDate(i.getDate()+o);break;case"hour":i.setTime(i.getTime()+36e5*o);break;case"minute":i.setTime(i.getTime()+6e4*o);break;case"second":i.setTime(i.getTime()+1e3*o);break;default:i=void 0}return i}(new Date,"minute",10))}),t.on("click",function(t){t.preventDefault();var e=i(this),t={};"product"===e.data("type")?(t.type="product",t.product_id=e.data("product")):"review"===e.data("type")?(t.type="review",t.product_id=e.data("product")):(t.type="custom",t.id=e.data("id")),T("update_stats",t).done(function(t){1!=woomotivObj.disable_link&&(location.href=e.find(".woomotiv-link").attr("href"))})})}),setTimeout(function(){a=s(function(){I(r+1)})},parseInt(p/2))}})}h?(v.products=j(),v.reviews=y(),v.custom=S()):A(),localStorage.getItem("woomotiv_pause_date_"+woomotivObj.site_hash)&&new Date(localStorage.getItem("woomotiv_pause_date_"+woomotivObj.site_hash))>new Date||D(v)}(jQuery);